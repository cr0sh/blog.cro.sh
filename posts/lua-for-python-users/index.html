<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Lua for Python Users | Option::None</title>
<meta name="keywords" content="">
<meta name="description" content="Lua에 대해 간단하게 알아봅시다.">
<meta name="author" content="">
<link rel="canonical" href="http://blog.cro.sh/posts/lua-for-python-users/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css" integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://blog.cro.sh/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://blog.cro.sh/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://blog.cro.sh/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://blog.cro.sh/apple-touch-icon.png">
<link rel="mask-icon" href="http://blog.cro.sh/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="stylesheet" href="http://blog.cro.sh/css/allow-horizontal-highlight-scroll.css"><link rel="stylesheet" href="http://blog.cro.sh/css/small-page-heading.css"><link rel="stylesheet" href="http://blog.cro.sh/css/fix-ios-hljs.css"><meta property="og:title" content="Lua for Python Users" />
<meta property="og:description" content="Lua에 대해 간단하게 알아봅시다." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://blog.cro.sh/posts/lua-for-python-users/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-14T09:35:34+09:00" />
<meta property="article:modified_time" content="2023-05-14T09:35:34+09:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Lua for Python Users"/>
<meta name="twitter:description" content="Lua에 대해 간단하게 알아봅시다."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://blog.cro.sh/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Lua for Python Users",
      "item": "http://blog.cro.sh/posts/lua-for-python-users/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Lua for Python Users",
  "name": "Lua for Python Users",
  "description": "Lua에 대해 간단하게 알아봅시다.\n",
  "keywords": [
    
  ],
  "articleBody": "Lua에 대해 간단하게 알아봅시다.\n참고: 이 글은 Python을 깊게 다루지 않으며 Python을 주로 ‘C처럼’ 다루는 사람들을 대상으로 작성했습니다. 메타테이블, 상속, 코루틴과 같이 깊은 주제는 의도적으로 배제되었습니다. 제목이 for Python Users인 이유도 그래서입니다. 작성자는 Lua를 단 일주일 해봤으니 너그럽게 봐 주시고, 잘못된 점이 있으면 이메일 hyun@cro.sh로 연락주시기 바랍니다. 또한, 이 글은 제가 사용하는 LuaJIT 2.1.0-beta3를 기준으로 작성되었습니다.\nWhy? Lua는 문법이 간단하며, 동적이라 자유도가 높고, 런타임이 아주 가벼우면서 빠릅니다(특히 LuaJIT을 사용할 경우). 그리고 C/C++/Rust 등의 정적 언어와 아주 잘 붙어서 이들의 보조적인 역할로 제격입니다.\n맛보기 print(\"hello, world!\") for i=1,100 do if i%3 == 0 and i%5 ~= 0 then print(\"fizz\") elseif i%3 ~= 0 and i%5 == 0 then print(\"buzz\") elseif i%3 == 0 and i%5 == 0 then print(\"fizzbuzz\") else print(i) end end function wow_iterator(max) local i = 0 return function() i = i + 1 if i \u003c= max then return i end return nil -- optional but recommended end end for i in wow_iterator(3) do print(i) end 기본 문법 변수 두 가지 종류가 있습니다.\n전역 변수: Python과 동일하게 name = \"global\"처럼 다른 키워드 없이 대입하면 자동으로 정의됩니다. 지역 변수보다 (아주 살짝) 느리기도 하고, Python과 다르게 모든 파일에 변수의 존재가 드러나므로 (유식하게 말해 모든 파일이 전역 변수의 이름공간을 공유하므로) 거의 사용하지 않습니다. 부득이하게 사용하게 되면 SCREAMING_SNAKE_CASE를 사용합시다. 지역 변수: local name = \"local\"처럼 대입식 앞에 local 을 붙입니다. 해당 파일, 함수, 혹은 제어문 안에서만 유효합니다. local a, b = 1, 2 처럼 한 번에 여러 변수를 정의할 수도 있습니다. a=1, b=2는 동작하지 않습니다. 목록의 끝에 있지 않은 값을 버릴 때에는 주로 _를 변수 이름으로 하여 대입하는 편입니다. 예를 들자면, local _, a = something() 과 같이 작성합니다. 함수 함수도 동일하게 지역/전역 구분이 존재합니다. local 키워드가 없으면 전역이므로 지역 함수만 서술합니다.\nlocal function say_hello(name) print(\"Hello, \" .. name .. \"!\") return 1, 2, 3 end a, b = say_hello(\"junghyun\") 먼저, def 대신 function 키워드를 사용해 정의합니다. Python과 다르게 코드 묶음은 들여쓰기로 표현하지 않으며 그 끝을 end로 표시하기만 하면 됩니다. Python과 비슷하게 줄바꿈으로 코드 조각 하나의 끝을 표시합니다. 세미콜론(;)을 써서 한 줄에 여러 코드를 표시합니다.\n뒤에서도 볼 수 있는데, 문법에 특수 문자를 거의 사용하지 않는 것이 특징입니다.\n함수는 여러 값을 반환할 수 있습니다. Python과 다른 점은 ‘튜플’ 타입이 따로 존재하지 않고 그저 ‘여러 값을 반환하는 함수’ 가 존재할 뿐이라는 것입니다. 그 결과값을 여러 변수에 각각 담을 수 있는 것도 동일합니다. 수량이 맞지 않으면 (변수가 너무 많을 경우) nil로 채워지거나, (변수가 너무 적을 경우) 값을 버립니다. 위에서는 3 값이 버려졌습니다.\n제어 구문 if 분기문입니다.\nif condition then run-if-condition-is-true elseif another-condition then run-if-another-condition-is-true else run-otherwise end if ... then ... end가 기본 세트입니다. elif 대신 elseif라고 부릅니다.\nwhile 반복문입니다.\nwhile condition do do-while-condition-is-true end while ... do ... end가 한 세트입니다. Python과 동일하게 break을 사용할 수 있으나, continue는 존재하지 않습니다.\nrepeat C의 do-while입니다. 조건과 관계없이 안의 코드를 최소 1회는 실행합니다.\nrepeat some-code until condition 자주 쓰이지는 않습니다.\nfor (numeric) 범위 반복문입니다. 아래 코드는 Python의 for i in range(start, end_+1):와 대응됩니다. (end는 키워드이므로 변수명으로 사용할 수 없습니다.)\nfor i in start, end_ do some-code end 여기서 주의할 점은, i의 범위가 닫힌 구간이라는 것입니다. 즉 start 이상 end_ 이하로, 이상-미만의 ‘반열린 구간’을 채택하는 대부분의 언어와는 조금 다릅니다.\nPython과 동일하게 세 번째 값으로 step을 제시할 수도 있습니다.\nfor (generic) Python의 for은 반복자(iterator)를 받아 반복자를 순회하는 제어문입니다. Lua의 generic for이 이에 대응됩니다.\nfor var_1, var_2, ..., var_n in iterator do some-code end 이는 다음과 비슷합니다.\nlocal var_1, var_2, ..., var_n = iterator() some-code local var_1, var_2, ..., var_n = iterator() some-code ... iterator가 꼭 단순 값일 필요는 없고 함수를 호출하는 수식일 수 있다는 점을 유의해야 합니다. 가장 많이 쓰는 함수 중 하나인 pairs의 예시를 들어보면:\nfor k, v in pairs(tbl) do some-code end 는\nlocal iterator = pairs(tbl); local k, v = iterator() some-code local k, v = iterator() some-code ... 와 대응됩니다.\n실제 generic for의 의미는 조금 더 확장되어 있습니다. 궁금하시면 https://www.lua.org/pil/7.2.html 를 참고하시기 바랍니다.\ndo (보너스) 자주 쓰이지는 않지만, C의 { ... }처럼 scope를 지정하고 싶을 때 do ... end를 사용할 수 있습니다. 지역 변수와 함께 조합하면 지역 변수가 유효한 범위를 제한할 수 있으므로 유용합니다.\n주석 한 줄 주석은 --으로 표시합니다. 여러 줄 주석은 --[[ ... ]] 사이에 글을 씁니다.\nlua-language-server을 사용한다면, doccomment는 함수나 변수 선언 위에 작성하고, ---으로 시작하면 되며 --- 뒤에 띄어쓰기가 있어서는 안 됩니다.\n자료형 어떤 값 value의 자료형은 type(value) 로 검사할 수 있습니다. \"nil\", \"boolean\", … \"thread\" 처럼 문자열 값이 반환됩니다.\nnil Python의 None에 대응됩니다. 존재하지 않는 값을 나타냅니다. 전역 변수나 테이블의 필드에 nil을 대입하면 해당 변수/필드를 없애는 의미가 있습니다.\nboolean true 혹은 false입니다. C와 비슷하게 소문자로 시작합니다.\nnumber 숫자입니다. Lua에는 별도의 정수 타입이 없습니다1. 즉 Python의float라고 생각하면 됩니다. 실수 타입이어도 2^53-1까지는 정수와 동일한 성질을 가지기 때문에 큰 문제가 없습니다. 더 큰 정수가 필요하면 Lua 객체로 구현하거나 C 등으로 따로 정의해서 사용할 수도 있습니다2.\nstring 문자열입니다. UTF-8이어야 한다는 보장은 없고 아무 바이트열이나 담을 수 있습니다. 파이썬의 b\"\"와 더 유사해 보입니다. \"\"나 ''을 사용해 나타냅니다. Stylua 포매터의 기본값에 따르면 \"\"이 좀 더 선호됩니다.\nfunction 함수입니다. Lua의 함수는 값으로 사용될 수 있습니다(유식하게 말해서 first-class value입니다). PIL의 표현을 빌리자면 변수에 저장될 수도 있고, 함수에 전달될 수도 있으며 반환값으로 쓰일 수도 있습니다.\nLua의 함수는 맥락을 보존합니다. 이를 closure라 합니다. 자세한 내용은 https://www.lua.org/pil/6.1.html 를 참고하시기 바랍니다.\ntable 가장 중요한 자료형입니다. Python에서 list에도 대응되고 dict에도 대응됩니다. 클래스 정의와 객체 지향 프로그래밍에도 사용됩니다. 위에서 나열한 기본적인 자료형을 묶을 수 있는 가장 보편적인 방법입니다.\n테이블은 키-값 쌍입니다. 여기서 키에는 nil 빼고 아무 것이나 들어갈 수 있습니다: boolean, number, string, function, … 대부분은 number 혹은 string입니다.\n테이블 정의에는 중괄호({, })를 사용합니다.\n배열 혹은 리스트처럼 테이블을 정의하려면, 키 없이 순서대로 나열하면 됩니다. 이 때, 각 원소들의 인덱스는 1부터 시작합니다.\nlocal array = {1, 2, 3} 딕셔너리처럼 테이블을 정의하려면, 키와 값을 나열하고 = 를 사이에 두면 됩니다.\nlocal dict = { name = \"John\", age = 32 } 키에 문법적으로 표현 불가능한 문자가 있으면 [\"\"]로 감쌉시다.\nlocal dict = { [\"first-name\"] = \"John\", [\"last-name\"] = \"Doe\" } 눈치채셨겠지만, 문자열이 아닌 값이나 심지어 변수를 [] 자리에 넣어도 됩니다. 묘기니까 하지는 맙시다.\nlocal a = \"first-name\" local b = \"last-name\" local dict = { [a] = \"John\", [b] = \"Doe\" } 당연히 빈 테이블을 선언하고( = {}) 나중에 값을 채울 수도 있습니다.\nPython과 동일하게 테이블의 값에 접근할 때는 [] 으로 접근합니다. tbl[\"xyz\"]는 tbl.xyz로 축약 가능합니다. tbl[xyz]와 혼동하지 않도록 주의하시기 바랍니다.\n테이블의 값으로 함수를 주고 싶을 때는 다음과 같이 정의할 수도 있습니다.\nfunction Table.function_name() some-code end Python의 ‘메서드’에 해당하는 함수 정의와 호출에는 구두점 대신 콜론을 사용합니다. self를 사용하는 점은 Python과 동일합니다. 아래 두 코드는 동일한 의미를 가집니다:\nfunction Human.say_hello(self, name) self.last_name = name; print(\"hello, \" .. name .. \"!\") end human = Human.create() -- creates a Human instance human.say_hello(human, \"Brian\") function Human:say_hello:(name) -- `self` is implicitly defined self.last_name = name; print(\"hello, \" .. name .. \"!\") end human = Human.create() -- creates a Human instance human:say_hello(\"Brian\") Python의 객체와 같이, 테이블 자체는 값이지만 그 안의 내용은 레퍼런스처럼 취급되기 때문에, Python에서 하던 것처럼 링크드 리스트나 트리를 구성하는 것도 가능합니다.\nuserdata C 등 외부에서 유래한 값입니다.\nthread 코루틴 객체로, LuaJIT에는 없는 타입입니다. 궁금하신 분들은 https://www.lua.org/pil/9.1.html 를 참고하시기 바랍니다.\n자주 쓰는 함수 require Python의 import와 같은 기능을 합니다. require(\"foo.bar\")는 foo/bar.lua를 읽어서 실행합니다. 즉 그 파일이 반환하는 값이 결과값이 됩니다. 그래서 대부분 모듈을 정의할 때는 테이블을 만들고 반환하는 식으로 표현합니다. 이 때는 변수 M이 주로 사용됩니다.\nlocal M = {} function M.say_hello() print(\"hello\") end return M string.format(fmt, arg1, arg2, ...) C의 sprintf와 유사합니다. 포맷 문자열을 사용해서 문자열에 값을 주입합니다. C와 서식 문자열을 동일하게 사용하므로 이를 참고하시기 바랍니다. https://en.cppreference.com/w/c/io/fprintf\npairs(tbl) 테이블의 키-값 쌍을 순회할 때 사용합니다. Python dict의 .items()를 생각하면 쉽습니다.\nfor k, v in pairs(tbl): end 는 Python의\nfor k, v in dictionary.items(): pass 와 비슷합니다.\nipairs(tbl) 테이블의 정수 키-값 쌍만 순회할 때 사용합니다.\nfor i, v in {1, 2, 3} print(string.format(\"%d -\u003e %d\", i, v)) end error(message) 오류를 발생시킵니다. Python의 throw 구문과 비슷하게 pcall/xpcall을 만날 때까지 호출되었던 기록을 거슬러 올라갑니다. message는 꼭 문자열일 필요는 없습니다.\nok, ret = pcall(func, arg1, arg2, ...) func(arg1, arg2, ...)을 실행시켜서 오류가 발생하면 첫 반환값을 false로 하고 오류의 내용을 두 번째 반환값으로 합니다. 오류가 발생하지 않으면 첫 반환값이 true가 되고 func의 반환값이 pcall의 두 번째 반환값이 됩니다.\n이 외에도 xpcall, debug 내장 모듈, math 내장 모듈을 찾아보면 좋습니다.\n자주 쓰는 도구 mlua Rust와 Lua를 잇는 다리입니다. 사용이 상당히 간편해 작성자는 애용하고 있습니다.\nlua-language-server Lua 언어의 LSP 구현체입니다. VSCode나 Vim에 결합되어 IDE와 같은 경험을 제공합니다. 확장된 문법으로 어노테이션을 지원합니다.\nStylua Black과 비슷한 Lua 언어의 포매터입니다. 포매팅 속도가 상당히 빠릅니다.\nReferences https://www.lua.org/pil/contents.html Lua 5.3에 추가되었으나, 상술한 바 대로 여기서는 Lua 5.1 및 일부 5.2 문법을 차용한 LuaJIT을 기준으로 하여 설명합니다. ↩︎\n여기에는 박싱으로 인한 성능 패널티가 존재하기 때문에 성능만을 위해 이렇게 하는 것은 큰 의미가 없을 것으로 생각됩니다(벤치마크해보지는 않았습니다). 작성자는 금융 계산을 위해 rust_decimal을 래핑해서 사용하고 있습니다. ↩︎\n",
  "wordCount" : "1409",
  "inLanguage": "en",
  "datePublished": "2023-05-14T09:35:34+09:00",
  "dateModified": "2023-05-14T09:35:34+09:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://blog.cro.sh/posts/lua-for-python-users/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Option::None",
    "logo": {
      "@type": "ImageObject",
      "url": "http://blog.cro.sh/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://blog.cro.sh/" accesskey="h" title="Option::None (Alt + H)">Option::None</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://blog.cro.sh/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Lua for Python Users
    </h1>
    <div class="post-meta"><span title='2023-05-14 09:35:34 +0900 KST'>May 14, 2023</span>

</div>
  </header> 
  <div class="post-content"><p>Lua에 대해 간단하게 알아봅시다.</p>
<blockquote>
<p>참고: 이 글은 Python을 깊게 다루지 않으며 Python을 주로 &lsquo;C처럼&rsquo; 다루는 사람들을 대상으로 작성했습니다. 메타테이블, 상속, 코루틴과 같이 깊은 주제는 의도적으로 배제되었습니다. 제목이 for Python <em>Users</em>인 이유도 그래서입니다. 작성자는 Lua를 <em>단 일주일</em> 해봤으니 너그럽게 봐 주시고, 잘못된 점이 있으면 이메일 <code>hyun@cro.sh</code>로 연락주시기 바랍니다. 또한, 이 글은 제가 사용하는 LuaJIT 2.1.0-beta3를 기준으로 작성되었습니다.</p>
</blockquote>
<h1 id="why">Why?<a hidden class="anchor" aria-hidden="true" href="#why">#</a></h1>
<p>Lua는 문법이 간단하며, 동적이라 자유도가 높고, 런타임이 아주 가벼우면서 빠릅니다(특히 LuaJIT을 사용할 경우). 그리고 C/C++/Rust 등의 정적 언어와 아주 잘 붙어서 이들의 보조적인 역할로 제격입니다.</p>
<h1 id="맛보기">맛보기<a hidden class="anchor" aria-hidden="true" href="#맛보기">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;hello, world!&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">100</span> <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> i<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">~=</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;fizz&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elseif</span> i<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">~=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> i<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;buzz&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">elseif</span> i<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> i<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;fizzbuzz&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        print(i)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">wow_iterator</span>(max)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">local</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span>()
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&lt;=</span> max <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> i
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span> <span style="color:#75715e">-- optional but recommended</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> wow_iterator(<span style="color:#ae81ff">3</span>) <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    print(i)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><h1 id="기본-문법">기본 문법<a hidden class="anchor" aria-hidden="true" href="#기본-문법">#</a></h1>
<h2 id="변수">변수<a hidden class="anchor" aria-hidden="true" href="#변수">#</a></h2>
<p>두 가지 종류가 있습니다.</p>
<ul>
<li>전역 변수: Python과 동일하게 <code>name = &quot;global&quot;</code>처럼 다른 키워드 없이 대입하면 자동으로 정의됩니다. 지역 변수보다 (아주 살짝) 느리기도 하고, Python과 다르게 <strong>모든 파일에 변수의 존재가 드러나므로</strong> (유식하게 말해 모든 파일이 전역 변수의 이름공간을 공유하므로) 거의 사용하지 않습니다. 부득이하게 사용하게 되면 SCREAMING_SNAKE_CASE를 사용합시다.</li>
<li>지역 변수: <code>local name = &quot;local&quot;</code>처럼 대입식 앞에 <code>local</code> 을 붙입니다. 해당 파일, 함수, 혹은 제어문 안에서만 유효합니다.
<code>local a, b = 1, 2</code> 처럼 한 번에 여러 변수를 정의할 수도 있습니다. <code>a=1, b=2</code>는 동작하지 않습니다. 목록의 끝에 있지 않은 값을 버릴 때에는 주로 <code>_</code>를 변수 이름으로 하여 대입하는 편입니다. 예를 들자면, <code>local _, a = something()</code> 과 같이 작성합니다.</li>
</ul>
<h2 id="함수">함수<a hidden class="anchor" aria-hidden="true" href="#함수">#</a></h2>
<p>함수도 동일하게 지역/전역 구분이 존재합니다. <code>local</code> 키워드가 없으면 전역이므로 지역 함수만 서술합니다.</p>
<pre tabindex="0"><code>local function say_hello(name)
    print(&#34;Hello, &#34; .. name .. &#34;!&#34;)
    return 1, 2, 3
end
a, b = say_hello(&#34;junghyun&#34;)
</code></pre><p>먼저, <code>def</code> 대신 <code>function</code> 키워드를 사용해 정의합니다. Python과 다르게 코드 묶음은 들여쓰기로 표현하지 않으며 그 끝을 <code>end</code>로 표시하기만 하면 됩니다. Python과 비슷하게 줄바꿈으로 코드 조각 하나의 끝을 표시합니다. 세미콜론(<code>;</code>)을 써서 한 줄에 여러 코드를 표시합니다.</p>
<blockquote>
<p>뒤에서도 볼 수 있는데, 문법에 특수 문자를 거의 사용하지 않는 것이 특징입니다.</p>
</blockquote>
<p>함수는 여러 값을 반환할 수 있습니다. Python과 다른 점은 &lsquo;튜플&rsquo; 타입이 따로 존재하지 않고 그저 &lsquo;여러 값을 반환하는 함수&rsquo; 가 존재할 뿐이라는 것입니다. 그 결과값을 여러 변수에 각각 담을 수 있는 것도 동일합니다. 수량이 맞지 않으면 (변수가 너무 많을 경우) <code>nil</code>로 채워지거나, (변수가 너무 적을 경우) 값을 버립니다. 위에서는 <code>3</code> 값이 버려졌습니다.</p>
<h2 id="제어-구문">제어 구문<a hidden class="anchor" aria-hidden="true" href="#제어-구문">#</a></h2>
<h3 id="if"><code>if</code><a hidden class="anchor" aria-hidden="true" href="#if">#</a></h3>
<p>분기문입니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> condition <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    run<span style="color:#f92672">-</span><span style="color:#66d9ef">if</span><span style="color:#f92672">-</span>condition<span style="color:#f92672">-</span>is<span style="color:#f92672">-</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elseif</span> another<span style="color:#f92672">-</span>condition <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    run<span style="color:#f92672">-</span><span style="color:#66d9ef">if</span><span style="color:#f92672">-</span>another<span style="color:#f92672">-</span>condition<span style="color:#f92672">-</span>is<span style="color:#f92672">-</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    run<span style="color:#f92672">-</span>otherwise
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p><code>if ... then ... end</code>가 기본 세트입니다. <code>elif</code> 대신 <code>elseif</code>라고 부릅니다.</p>
<h3 id="while"><code>while</code><a hidden class="anchor" aria-hidden="true" href="#while">#</a></h3>
<p>반복문입니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">while</span> condition <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">do</span><span style="color:#f92672">-</span><span style="color:#66d9ef">while</span><span style="color:#f92672">-</span>condition<span style="color:#f92672">-</span>is<span style="color:#f92672">-</span><span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p><code>while ... do ... end</code>가 한 세트입니다. Python과 동일하게 <code>break</code>을 사용할 수 있으나, <strong><code>continue</code>는 존재하지 않습니다.</strong></p>
<h3 id="repeat"><code>repeat</code><a hidden class="anchor" aria-hidden="true" href="#repeat">#</a></h3>
<p>C의 do-while입니다. 조건과 관계없이 안의 코드를 최소 1회는 실행합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">repeat</span>
</span></span><span style="display:flex;"><span>    some<span style="color:#f92672">-</span>code
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">until</span> condition
</span></span></code></pre></div><p>자주 쓰이지는 않습니다.</p>
<h3 id="for-numeric"><code>for</code> (numeric)<a hidden class="anchor" aria-hidden="true" href="#for-numeric">#</a></h3>
<p>범위 반복문입니다. 아래 코드는 Python의 <code>for i in range(start, end_+1):</code>와 대응됩니다.
(<code>end</code>는 키워드이므로 변수명으로 사용할 수 없습니다.)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> start, end_ <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    some<span style="color:#f92672">-</span>code
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>여기서 주의할 점은, <code>i</code>의 범위가 <strong>닫힌 구간</strong>이라는 것입니다. 즉 <code>start</code> <strong>이상</strong> <code>end_</code> <strong>이하</strong>로, 이상-미만의 &lsquo;반열린 구간&rsquo;을 채택하는 대부분의 언어와는 조금 다릅니다.</p>
<p>Python과 동일하게 세 번째 값으로 <code>step</code>을 제시할 수도 있습니다.</p>
<h3 id="for-generic"><code>for</code> (generic)<a hidden class="anchor" aria-hidden="true" href="#for-generic">#</a></h3>
<p>Python의 for은 반복자(iterator)를 받아 반복자를 순회하는 제어문입니다. Lua의 generic for이 이에 대응됩니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> var_1, var_2, ..., var_n <span style="color:#66d9ef">in</span> iterator <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    some<span style="color:#f92672">-</span>code
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>이는 다음과 비슷합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> var_1, var_2, ..., var_n <span style="color:#f92672">=</span> iterator()
</span></span><span style="display:flex;"><span>some<span style="color:#f92672">-</span>code
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> var_1, var_2, ..., var_n <span style="color:#f92672">=</span> iterator()
</span></span><span style="display:flex;"><span>some<span style="color:#f92672">-</span>code
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>iterator가 꼭 단순 값일 필요는 없고 함수를 호출하는 수식일 수 있다는 점을 유의해야 합니다. 가장 많이 쓰는 함수 중 하나인 <code>pairs</code>의 예시를 들어보면:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k, v <span style="color:#66d9ef">in</span> pairs(tbl) <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    some<span style="color:#f92672">-</span>code
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>는</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> iterator <span style="color:#f92672">=</span> pairs(tbl);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> k, v <span style="color:#f92672">=</span> iterator()
</span></span><span style="display:flex;"><span>some<span style="color:#f92672">-</span>code
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> k, v <span style="color:#f92672">=</span> iterator()
</span></span><span style="display:flex;"><span>some<span style="color:#f92672">-</span>code
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>와 대응됩니다.</p>
<blockquote>
<p>실제 generic for의 의미는 조금 더 확장되어 있습니다. 궁금하시면 <a href="https://www.lua.org/pil/7.2.html">https://www.lua.org/pil/7.2.html</a> 를 참고하시기 바랍니다.</p>
</blockquote>
<h3 id="do-보너스"><code>do</code> (보너스)<a hidden class="anchor" aria-hidden="true" href="#do-보너스">#</a></h3>
<p>자주 쓰이지는 않지만, C의 <code>{ ... }</code>처럼 scope를 지정하고 싶을 때 <code>do ... end</code>를 사용할 수 있습니다. 지역 변수와 함께 조합하면 지역 변수가 유효한 범위를 제한할 수 있으므로 유용합니다.</p>
<h2 id="주석">주석<a hidden class="anchor" aria-hidden="true" href="#주석">#</a></h2>
<p>한 줄 주석은 <code>--</code>으로 표시합니다. 여러 줄 주석은 <code>--[[ ... ]]</code> 사이에 글을 씁니다.</p>
<p>lua-language-server을 사용한다면, doccomment는 함수나 변수 선언 위에 작성하고, <code>---</code>으로 시작하면 되며 <code>---</code> 뒤에 띄어쓰기가 있어서는 안 됩니다.</p>
<h1 id="자료형">자료형<a hidden class="anchor" aria-hidden="true" href="#자료형">#</a></h1>
<p>어떤 값 <code>value</code>의 자료형은 <code>type(value)</code> 로 검사할 수 있습니다. <code>&quot;nil&quot;</code>, <code>&quot;boolean&quot;</code>, &hellip; <code>&quot;thread&quot;</code> 처럼 문자열 값이 반환됩니다.</p>
<h2 id="nil"><code>nil</code><a hidden class="anchor" aria-hidden="true" href="#nil">#</a></h2>
<p>Python의 None에 대응됩니다. 존재하지 않는 값을 나타냅니다. 전역 변수나 테이블의 필드에 <code>nil</code>을 대입하면 해당 변수/필드를 없애는 의미가 있습니다.</p>
<h2 id="boolean"><code>boolean</code><a hidden class="anchor" aria-hidden="true" href="#boolean">#</a></h2>
<p><code>true</code> 혹은 <code>false</code>입니다. C와 비슷하게 소문자로 시작합니다.</p>
<h2 id="number"><code>number</code><a hidden class="anchor" aria-hidden="true" href="#number">#</a></h2>
<p>숫자입니다. <strong>Lua에는 별도의 정수 타입이 없습니다</strong><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>. 즉 Python의<code>float</code>라고 생각하면 됩니다. 실수 타입이어도 2^53-1까지는 정수와 동일한 성질을 가지기 때문에 큰 문제가 없습니다. 더 큰 정수가 필요하면 Lua 객체로 구현하거나 C 등으로 따로 정의해서 사용할 수도 있습니다<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>.</p>
<h2 id="string"><code>string</code><a hidden class="anchor" aria-hidden="true" href="#string">#</a></h2>
<p>문자열입니다. UTF-8이어야 한다는 보장은 없고 아무 바이트열이나 담을 수 있습니다. 파이썬의 <code>b&quot;&quot;</code>와 더 유사해 보입니다. <code>&quot;&quot;</code>나 <code>''</code>을 사용해 나타냅니다. Stylua 포매터의 기본값에 따르면 <code>&quot;&quot;</code>이 좀 더 선호됩니다.</p>
<h2 id="function"><code>function</code><a hidden class="anchor" aria-hidden="true" href="#function">#</a></h2>
<p>함수입니다. Lua의 함수는 값으로 사용될 수 있습니다(유식하게 말해서 first-class value입니다). PIL의 표현을 빌리자면 변수에 저장될 수도 있고, 함수에 전달될 수도 있으며 반환값으로 쓰일 수도 있습니다.</p>
<p>Lua의 함수는 맥락을 보존합니다. 이를 closure라 합니다. 자세한 내용은 <a href="https://www.lua.org/pil/6.1.html">https://www.lua.org/pil/6.1.html</a> 를 참고하시기 바랍니다.</p>
<h2 id="table"><code>table</code><a hidden class="anchor" aria-hidden="true" href="#table">#</a></h2>
<p>가장 중요한 자료형입니다. Python에서 <code>list</code>에도 대응되고 <code>dict</code>에도 대응됩니다. 클래스 정의와 객체 지향 프로그래밍에도 사용됩니다. 위에서 나열한 기본적인 자료형을 묶을 수 있는 가장 보편적인 방법입니다.</p>
<p>테이블은 키-값 쌍입니다. 여기서 키에는 <code>nil</code> 빼고 아무 것이나 들어갈 수 있습니다: <code>boolean</code>, <code>number</code>, <code>string</code>, <code>function</code>, &hellip; 대부분은 <code>number</code> 혹은 <code>string</code>입니다.</p>
<p>테이블 정의에는 중괄호(<code>{</code>, <code>}</code>)를 사용합니다.</p>
<p>배열 혹은 리스트처럼 테이블을 정의하려면, 키 없이 순서대로 나열하면 됩니다. <strong>이 때, 각 원소들의 인덱스는 1부터 시작합니다.</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> array <span style="color:#f92672">=</span> {<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>}
</span></span></code></pre></div><p>딕셔너리처럼 테이블을 정의하려면, 키와 값을 나열하고 <code>=</code> 를 사이에 두면 됩니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> dict <span style="color:#f92672">=</span> { name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;John&#34;</span>, age <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span> }
</span></span></code></pre></div><p>키에 문법적으로 표현 불가능한 문자가 있으면 <code>[&quot;&quot;]</code>로 감쌉시다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> dict <span style="color:#f92672">=</span> { [<span style="color:#e6db74">&#34;first-name&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;John&#34;</span>, [<span style="color:#e6db74">&#34;last-name&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Doe&#34;</span> }
</span></span></code></pre></div><p>눈치채셨겠지만, 문자열이 아닌 값이나 심지어 변수를 <code>[]</code> 자리에 넣어도 됩니다. 묘기니까 하지는 맙시다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> a <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;first-name&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> b <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;last-name&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> dict <span style="color:#f92672">=</span> { [a] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;John&#34;</span>, [b] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Doe&#34;</span> }
</span></span></code></pre></div><p>당연히 빈 테이블을 선언하고(<code> = {}</code>) 나중에 값을 채울 수도 있습니다.</p>
<p>Python과 동일하게 테이블의 값에 접근할 때는 <code>[]</code> 으로 접근합니다. <code>tbl[&quot;xyz&quot;]</code>는 <code>tbl.xyz</code>로 축약 가능합니다. <code>tbl[xyz]</code>와 혼동하지 않도록 주의하시기 바랍니다.</p>
<p>테이블의 값으로 함수를 주고 싶을 때는 다음과 같이 정의할 수도 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Table</span>.<span style="color:#a6e22e">function_name</span>()
</span></span><span style="display:flex;"><span>    some<span style="color:#f92672">-</span>code
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>Python의 &lsquo;메서드&rsquo;에 해당하는 함수 정의와 호출에는 구두점 대신 콜론을 사용합니다. <code>self</code>를 사용하는 점은 Python과 동일합니다. 아래 두 코드는 동일한 의미를 가집니다:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Human</span>.<span style="color:#a6e22e">say_hello</span>(self, name)
</span></span><span style="display:flex;"><span>    self.last_name <span style="color:#f92672">=</span> name;
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;hello, &#34;</span> <span style="color:#f92672">..</span> name <span style="color:#f92672">..</span> <span style="color:#e6db74">&#34;!&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>human <span style="color:#f92672">=</span> Human.create() <span style="color:#75715e">-- creates a Human instance</span>
</span></span><span style="display:flex;"><span>human.say_hello(human, <span style="color:#e6db74">&#34;Brian&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Human</span>:<span style="color:#a6e22e">say_hello</span>:(name) <span style="color:#75715e">-- `self` is implicitly defined</span>
</span></span><span style="display:flex;"><span>    self.last_name <span style="color:#f92672">=</span> name;
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;hello, &#34;</span> <span style="color:#f92672">..</span> name <span style="color:#f92672">..</span> <span style="color:#e6db74">&#34;!&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>human <span style="color:#f92672">=</span> Human.create() <span style="color:#75715e">-- creates a Human instance</span>
</span></span><span style="display:flex;"><span>human:say_hello(<span style="color:#e6db74">&#34;Brian&#34;</span>)
</span></span></code></pre></div><p>Python의 객체와 같이, 테이블 자체는 값이지만 그 안의 내용은 레퍼런스처럼 취급되기 때문에, Python에서 하던 것처럼 링크드 리스트나 트리를 구성하는 것도 가능합니다.</p>
<h2 id="userdata"><code>userdata</code><a hidden class="anchor" aria-hidden="true" href="#userdata">#</a></h2>
<p>C 등 외부에서 유래한 값입니다.</p>
<h2 id="thread"><code>thread</code><a hidden class="anchor" aria-hidden="true" href="#thread">#</a></h2>
<p>코루틴 객체로, LuaJIT에는 없는 타입입니다. 궁금하신 분들은 <a href="https://www.lua.org/pil/9.1.html">https://www.lua.org/pil/9.1.html</a> 를 참고하시기 바랍니다.</p>
<h1 id="자주-쓰는-함수">자주 쓰는 함수<a hidden class="anchor" aria-hidden="true" href="#자주-쓰는-함수">#</a></h1>
<h2 id="require"><code>require</code><a hidden class="anchor" aria-hidden="true" href="#require">#</a></h2>
<p>Python의 <code>import</code>와 같은 기능을 합니다. <code>require(&quot;foo.bar&quot;)</code>는 <code>foo/bar.lua</code>를 읽어서 <strong>실행합니다</strong>. 즉 그 파일이 반환하는 값이 결과값이 됩니다. 그래서 대부분 모듈을 정의할 때는 테이블을 만들고 반환하는 식으로 표현합니다. 이 때는 변수 <code>M</code>이 주로 사용됩니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> M <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">M</span>.<span style="color:#a6e22e">say_hello</span>()
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;hello&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> M
</span></span></code></pre></div><h2 id="stringformatfmt-arg1-arg2-"><code>string.format(fmt, arg1, arg2, ...)</code><a hidden class="anchor" aria-hidden="true" href="#stringformatfmt-arg1-arg2-">#</a></h2>
<p>C의 <code>sprintf</code>와 유사합니다. 포맷 문자열을 사용해서 문자열에 값을 주입합니다. C와 서식 문자열을 동일하게 사용하므로 이를 참고하시기 바랍니다. <a href="https://en.cppreference.com/w/c/io/fprintf">https://en.cppreference.com/w/c/io/fprintf</a></p>
<h2 id="pairstbl"><code>pairs(tbl)</code><a hidden class="anchor" aria-hidden="true" href="#pairstbl">#</a></h2>
<p>테이블의 키-값 쌍을 순회할 때 사용합니다. Python <code>dict</code>의 <code>.items()</code>를 생각하면 쉽습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k, v <span style="color:#66d9ef">in</span> pairs(tbl):
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>는 Python의</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k, v <span style="color:#f92672">in</span> dictionary<span style="color:#f92672">.</span>items():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span></code></pre></div><p>와 비슷합니다.</p>
<h2 id="ipairstbl"><code>ipairs(tbl)</code><a hidden class="anchor" aria-hidden="true" href="#ipairstbl">#</a></h2>
<p>테이블의 <strong>정수</strong> 키-값 쌍만 순회할 때 사용합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i, v <span style="color:#66d9ef">in</span> {<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>}
</span></span><span style="display:flex;"><span>    print(string.format(<span style="color:#e6db74">&#34;%d -&gt; %d&#34;</span>, i, v))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><h2 id="errormessage"><code>error(message)</code><a hidden class="anchor" aria-hidden="true" href="#errormessage">#</a></h2>
<p>오류를 발생시킵니다. Python의 <code>throw</code> 구문과 비슷하게 <code>pcall</code>/<code>xpcall</code>을 만날 때까지 호출되었던 기록을 거슬러 올라갑니다. <code>message</code>는 꼭 문자열일 필요는 없습니다.</p>
<h2 id="ok-ret--pcallfunc-arg1-arg2-"><code>ok, ret = pcall(func, arg1, arg2, ...)</code><a hidden class="anchor" aria-hidden="true" href="#ok-ret--pcallfunc-arg1-arg2-">#</a></h2>
<p><code>func(arg1, arg2, ...)</code>을 실행시켜서 오류가 발생하면 첫 반환값을 <code>false</code>로 하고 오류의 내용을 두 번째 반환값으로 합니다. 오류가 발생하지 않으면 첫 반환값이 <code>true</code>가 되고 <code>func</code>의 반환값이 <code>pcall</code>의 두 번째 반환값이 됩니다.</p>
<blockquote>
<p>이 외에도 <code>xpcall</code>, <code>debug</code> 내장 모듈, <code>math</code> 내장 모듈을 찾아보면 좋습니다.</p>
</blockquote>
<h1 id="자주-쓰는-도구">자주 쓰는 도구<a hidden class="anchor" aria-hidden="true" href="#자주-쓰는-도구">#</a></h1>
<h2 id="mluahttpslibrscratesmlua"><a href="https://lib.rs/crates/mlua">mlua</a><a hidden class="anchor" aria-hidden="true" href="#mluahttpslibrscratesmlua">#</a></h2>
<p>Rust와 Lua를 잇는 다리입니다. 사용이 상당히 간편해 작성자는 애용하고 있습니다.</p>
<h2 id="lua-language-serverhttpsgithubcomlualslua-language-server"><a href="https://github.com/LuaLS/lua-language-server">lua-language-server</a><a hidden class="anchor" aria-hidden="true" href="#lua-language-serverhttpsgithubcomlualslua-language-server">#</a></h2>
<p>Lua 언어의 <a href="https://microsoft.github.io/language-server-protocol/">LSP</a> 구현체입니다. VSCode나 Vim에 결합되어 IDE와 같은 경험을 제공합니다. 확장된 문법으로 <a href="https://github.com/LuaLS/lua-language-server/wiki/Annotations">어노테이션</a>을 지원합니다.</p>
<h2 id="styluahttpsgithubcomjohnnymorganzstylua"><a href="https://github.com/JohnnyMorganz/StyLua">Stylua</a><a hidden class="anchor" aria-hidden="true" href="#styluahttpsgithubcomjohnnymorganzstylua">#</a></h2>
<p>Black과 비슷한 Lua 언어의 포매터입니다. 포매팅 속도가 상당히 빠릅니다.</p>
<h1 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h1>
<ul>
<li><a href="https://www.lua.org/pil/contents.html">https://www.lua.org/pil/contents.html</a></li>
</ul>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Lua 5.3에 추가되었으나, 상술한 바 대로 여기서는 Lua 5.1 및 일부 5.2 문법을 차용한 LuaJIT을 기준으로 하여 설명합니다.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>여기에는 박싱으로 인한 성능 패널티가 존재하기 때문에 성능만을 위해 이렇게 하는 것은 큰 의미가 없을 것으로 생각됩니다(벤치마크해보지는 않았습니다). 작성자는 금융 계산을 위해 <a href="https://lib.rs/crates/rust_decimal"><code>rust_decimal</code></a>을 래핑해서 사용하고 있습니다.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>© 2019-2023 Nam Junghyun</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>
<script defer src='https://static.cloudflareinsights.com/beacon.min.js'
    data-cf-beacon='{"token": "152863abaa9948f9bb84e53ef4204e47"}'></script>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
