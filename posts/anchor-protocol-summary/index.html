<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Anchor Protocol Summary | Option::None</title>
<meta name="keywords" content="">
<meta name="description" content="Anchor Protocol Summary - Option::None">
<meta name="author" content="">
<link rel="canonical" href="http://blog.cro.sh/posts/anchor-protocol-summary/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css" integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="http://blog.cro.sh/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://blog.cro.sh/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://blog.cro.sh/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://blog.cro.sh/apple-touch-icon.png">
<link rel="mask-icon" href="http://blog.cro.sh/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="stylesheet" href="http://blog.cro.sh/css/allow-horizontal-highlight-scroll.css"><link rel="stylesheet" href="http://blog.cro.sh/css/small-page-heading.css"><meta property="og:title" content="Anchor Protocol Summary" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://blog.cro.sh/posts/anchor-protocol-summary/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-27T13:08:18+09:00" />
<meta property="article:modified_time" content="2022-02-27T13:08:18+09:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Anchor Protocol Summary"/>
<meta name="twitter:description" content=""/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://blog.cro.sh/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Anchor Protocol Summary",
      "item": "http://blog.cro.sh/posts/anchor-protocol-summary/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Anchor Protocol Summary",
  "name": "Anchor Protocol Summary",
  "description": "",
  "keywords": [
    
  ],
  "articleBody": "Disclaimer 이 문서는 투자를 권유하는 내용이 아니며 정보 제공만을 목적으로 합니다. 부정확한 정보가 포함되었을 수 있습니다(발견 시 지적 부탁드립니다). 가상자산 및 가상자산 기반의 DApp에 투자하여 발생하는 모든 손실의 책임은 투자자 개인에게 있습니다.\n앵커 프로토콜 앵커는 테라 블록체인의 은행 역할을 수행하는 프로토콜이다. 정확히는 화폐의 대차 업무를 담당하게 된다. 즉, 저축된 자산을 기반으로 대출자들에게 돈을 빌려주고 이자를 받아 배분하는 역할을 한다.\nbAssets (Bonded Assets) PoS(Proof-of-Stake) Bonded assets에 대해 알기 전에 먼저 PoS(Proof-of-Stake, 지분증명) 블록체인에 대한 이해가 필요하다.\n비트코인, 이더리움과 같은 초기의 블록체인은 PoW(Proof-of-Work, 작업증명) 방식으로 블록체인의 신뢰성을 유지하는데, 이는 성능이 좋은 CPU나 GPU, 혹은 전용 채굴 칩을 사용하여 내가 ‘아주 어려운 문제1‘를 풀어낸 답을 제시하여 자신이 암호화폐를 채굴해냈음을 증명한다(다른 말로, 새로 발행한 다음 자신이 소유함을 증명한다).\n지분증명 블록체인은 이 대신, 채굴자들이 이전까지 발행되었던 암호화폐를 소유하고 있음만을 증명하며 이에 따라 암호화폐를 발행하게 된다(PoW에 비해 문제의 난이도는 매우 낮음). PoS 블록체인에서는 채굴을 위해서 암호화폐를 소유하면서 블록체인에서 다른 채굴자와 통신할 서버를 운영해야 하는데, 암호화폐를 소유한 개개인이 이런 서버를 구동하기에는 번거롭기 때문에 대부분 서버를 운영하는 사람에게 자신이 소유한 암호화폐를 위임하여 채굴을 의뢰하게 된다.\nPoS 방식으로 운용되는 블록체인으로는 테라(앵커 프로토콜이 구동되는 체인), 솔라나, 이더리움 비콘 체인(이더리움 2.0) 등이 있다.\nRisk of Delegation 암호화폐를 채굴자에게 위임하는 것은 100% 수익을 보장하지는 않는다. 채굴자가 구동하는 서버가 오작동하여 블록체인 상에서 제대로 기능하지 못할 경우, 다른 채굴자들은 오작동한 채굴자에게 ‘처벌(slashing)‘을 가할 수 있다. 이는 채굴자가 보유한 암호화폐가 일부 손실됨을 의미한다. 채굴자가 처벌받을 수 있는 경우는 다음을 포함한다.\n채굴자가 구동하는 채굴 프로그램의 오류 채굴자가 구동하는 서버에 대한 DDoS 등 외부에서의 공격 채굴자가 구동하는 서버가 정전됨 채굴자가 위임받은 암호화폐를 횡령하거나 임의로 삭제시키는 것은 PoS 블록체인의 설계 상 불가능하다2.\nBonded Assets 앵커 프로토콜에서 가치를 창출하는 방법 중 하나는 위의 PoS 블록체인에 암호화폐를 위임함으로서 채굴 수익을 얻는 것이다. 테라 블록체인의 암호화폐인 LUNA를 예로 들면, LUNA 보유자들은 bLUNA 토큰을 LUNA와 1:1로3 교환할 수 있다. 엄밀히 표현하면, LUNA를 채굴자에게 위임함으로서 동일한 양의 bLUNA를 발행할 수 있다. 위임된 LUNA는 바로 가져갈 수 없으며 최소 21일간 잠금(lock-up)하여 채굴에 사용된다. 잠금 기간이 끝난 후에는 bLUNA를 다시 반납하고 위임했던 LUNA를 돌려받고 채굴 수익도 청구할 수 있다. 채굴 수익은 테라 블록체인의 스테이블코인인 UST로 지급된다.\nLUNA 외에도 이더리움과 Lido Finance가 제공하는 이더리움 예치 서비스를 이용해 bETH를 발행할 수도 있다.\nStablecoins 스테이블코인에 대해 간략히 설명하겠다. 블록체인 위에서 달러를 직접 다루기에는 기술적/법적 문제가 있기 때문에, 달러 혹은 다른 기존 화폐와 가치가 연동되는(pegged) 암호화폐를 달러 대신 사용한다(주로 달러에 페깅된 스테이블코인만을 취급하는 곳이 많다). 시가총액이 높고 유명한 스테이블코인들을 간단히 설명하겠다.\nUSDT(Tether) Tether 사에서 발행하는 스테이블코인으로, 달러를 예치하면 동일한 양의 USDT를 발행해준다. 발행사인 Tether가 조세회피처인 케이만 제도에 있다거나, 예치된 달러가 부실 채권 구매에 사용되었을 수 있다거나(특히 헝다그룹), 예치량보다 더 많은 USDT를 발행했다는 논란이 있어 신뢰성 문제가 있지만 아직까지는 스테이블코인 중 가장 시가총액이 높다.\nUSDC(USD Coin) 기본적인 원리는 Tether와 동일하지만 Centre Consortium이라는 기존 금융시장에서 신뢰할 만한 회사들이 모인 공동체가 주체가 되어 발행한다. USDT보다 신뢰성 문제가 적기 때문에 최근 시가총액이 크게 증가하고 있으며 근미래에 USDT를 추월할 수 있다고 평가받는다.\nDAI USDT, USDC는 발행 주체가 ‘중앙화’되어있기 때문에 발행 주체를 전적으로 신뢰해야 한다는 문제가 있다. 예를 들어, USDT와 USDC 모두 특정 계정(주로 해킹으로 USDT, USDC를 탈취한 계정)의 USDT/USDC 자금 이동을 정지시키는 일을 할 수 있는데, 이는 탈중앙화를 기본 이념으로 하는 암호화폐 생태계와 맞지 않기 때문에 탈중앙화된, 블록체인의 스마트 컨트랙트로만 컨트롤되는 암호화폐의 필요성이 대두되었다.\nDAI는 암호화폐를 담보로 하여 발행받는 스테이블코인이다. 블록체인 위에서 구동되는 DApp에 암호화폐를 예치하면 DAI를 ‘대출’해주며, 블록체인의 특성상 무신용 대출이기 때문에 100% 미만의 LTV로만 대출받을 수 있다(이를 overcollaterized loan이라고도 한다). 담보로 맡긴 암호화폐의 가치가 하락하면 경매를 통해 맡긴 담보가 강제로 청산된다.\nUST(TerraUSD) DAI는 블록체인 상에서 발행과 청산이 모두 이루어지며 이 모든 것이 조작 불가능한, 그리고 민주적인 방식으로 이루어지기 때문에 스테이블코인의 탈중앙화를 이루었다고 평가받는다. 하지만 DAI는 발행이 항상 overcollaterized loan으로만 이루어지기 때문에 담보로 맡길 수 있는 암호화폐의 시가총액보다 DAI를 더 많이 발행할 수 없다는 문제가 발생한다(따지고 보면 USDT/USDC도 달러의 발행량보다 더 많이 발행될 수 없다는 문제가 있지만 암호화폐 담보와 비교할 바는 아니다). 테라는 이를 해결하기 위해 등장한 프로젝트로, 담보자산 없이 달러와 가치가 연동되는 스테이블코인을 만드는 것을 목표로 한다. 테라의 주된 암호화폐는 LUNA와 UST가 있다. 이를 통해 어떻게 UST가 USD와 가치가 연동되는지 알아보자4.\n항상 1 UST는 1달러 가치의 LUNA와 교환할 수 있다. 이는 테라 블록체인이 항상 보장한다. 아래의 예시에서 1 LUNA = 100 USD로 가정한다. 1 UST가 시장에서 1.01 USD의 가치를 지닌다면(UST의 유통량이 너무 적음): 시장에서 100 USD로 1 LUNA를 구입한다. 1 LUNA를 소각하고 100 UST를 발행한다. 100 UST를 101 USD로 팔아 1 USD의 차익을 얻는다. 시장에는 추가적인 UST가 풀림으로서 수요에 맞춰 공급량이 늘어난다. 1 UST가 시장에서 0.99 USD의 가치를 지닌다면(UST의 유통량이 너무 많음): 시장에서 100 UST를 99 USD에 산다. 100 UST를 소각하고 1 LUNA를 발행한다. 1 LUNA를 100 USD로 팔아 1 USD의 차익을 얻는다. UST의 유통량이 감소함으로서 줄어든 수요에 맞춰 공급량이 감소한다. UST의 가격 유지는 이러한 차익거래만으로 이루어지며, 이렇게 담보 없이 알고리즘만으로 유지되는 스테이블코인을 algorithmic stablecoin이라 부른다. UST는 알고리즘 스테이블코인 중 가장 시가총액이 높다.\nUST의 장점은 다음과 같다.\n탈중앙화: UST를 소유함으로서 특정 주체를 무한정 신뢰해야 할 필요가 없다. 확장성: 직접적으로 달러나 암호화폐를 담보로 삼지 않기 때문에, 발행량에 제한이 없다. UST의 위험성은 다음과 같다.\n검증되지 않음: 테라 프로젝트는 시작된 지 3년이 채 되지 않았다. 차익거래 알고리즘만으로 UST의 가격이 달러와 연동된다고 단언하기에는 불충분하다. 급격한 가격변동에 취약함: 비트코인 폭락 등으로 LUNA의 가격이 같이 폭락하면 차익거래 수요가 증가하지만 LUNA/UST를 소각 및 변환하는 양은 하루 단위로 제한되어 있다. 이로 인해 비트코인 폭락 시 깨진 페깅이 며칠에 걸쳐 복구된 적이 있었다. 최근 Binance와 같은 거래소에 UST/USDT 마켓 등이 추가되면서 이는 다소 개선될 것으로 보인다. 또한, LUNA의 시가총액이 크게 감소하면 공포에 빠진 사람들이 UST로 LUNA를 발행해 매도할 수 있으며 이는 LUNA 가격의 급락을 가속화시키는 악순환을 만들 수 있다(death spiral). 이 문제는 테라 팀에서도 인지하고 있는 듯 하며, 최근에 LFG(Luna Foundation Guard)가 출범하면서 1조원어치의 비트코인을 추가 담보로 삼아 LUNA와 동일하게 발행 및 소각할 수 있도록 하여 추가적인 신뢰성을 확보하였다. 제도권과의 마찰: 테라를 개발한 Terraform Labs의 대표 권도형(Do Kwon)은 2021 말 SEC에게서 소환장을 받은 바 있고 이 마찰은 아직 진행중이다. 소환 사유는 SEC가 테라 블록체인의 DApp 중 하나인 Mirror Protocol이 미허가 증권을 발행한 것으로 해석했기 때문이다. Mirror Protocol은 간단히 설명하면 Mirrored Assets를 발행하는 DApp으로 실제 증권(Amazon, Microsoft, Tesla 주식 등) 등의 가격을 추종하는 토큰이다(TSLA 가격을 추종하는 mTSLA, BTC 가격을 추종하는 mBTC 등). 이는 2020년 SEC가 Ripple 코인을 발행하는 Ripple사를 증권법 위반으로 고발한 것과도 유사하다. 이 분쟁은 2년 넘게 계속 이어지고 있다. 권도형은 자신이 한국인이며 Terraform Labs는 한국/싱가포르 법인이기 때문에 이는 초법적 조치라며 항변하였고 SEC와 민사 소송을 진행하고 있다. 2022년 2월 기준, 아직까지는 1 UST = 1 USD로 가치가 잘 연동되고 있으며 간혹 페깅이 깨지는 경우도 있었지만 대부분 3~4일 내로 복구되는 모습을 보이고 있다.\nMoney Market 앵커 프로토콜의 대출 기능이다. 사용자는 UST를 대출 풀에 예치하고 이자 수익을 얻거나, 위에서 설명한 bonded asset을 담보로 맡기고 UST를 대출할 수 있다. 이 역시 무신용 대출이기 때문에 최대 LTV는 80%로 overcollaterize 되어 있으며, 담보 가치가 하락하면 청산이 일어날 수 있다. 그럼에도 불구하고 대출 수요가 존재하는 이유는 다음과 같다.\n대출받은 UST로 다른 암호화폐를 구입하면 담보로 맡긴 암호화폐와 함께 가격 변동에 노출되므로 레버리지 효과를 얻을 수 있다. 대출자에게도 ANC라는 자체 토큰을 발행해 지급하는데, 대출 이자보다 ANC 토큰으로 얻는 가치가 높기 때문에(총합 연이율 단리 3.8% 수준/2022년 2월 27일 기준) 담보물의 가치 변동을 무시하면 대출만 해도 이득이다. 앵커 프로토콜은 Anchor Rate라는 목표 이자율을 설정한 뒤(이는 후에 설명할 ANC 토큰을 통한 투표로 이루어진다), 목표 이자율을 초과 달성하면 Yield Reserve라는 준비기금에 초과액을 저장하고 미달성하면 저장한 Yield Reserve에서 돈을 충당하여 UST를 제공한 사람들에게 이자를 지급한다. 현재 앵커의 이자율은 1년 복리 19.3% 수준을 유지하고 있다.\n최근 앵커에 대한 우려 앵커의 수익 원천은 결국 대출자들이 지급하는 이자 및 예치한 Bonded Asset에서 나오는 채굴 수익이다. 시장이 전체적으로 상승장일 때는 이러한 수익이 많이 나오기 때문에 UST 제공자들에게 이자를 지급하기 용이하지만, 최근과 같이 전체적으로 하락 중일때는 목표 이자율을 달성하기 어렵고 이로 인해 Yield Reserve에 저장된 금액을 지속적으로 소모하게 된다. 앵커의 Yield Reserve는 2월 초에 700만 달러까지 감소하였으며 모두 소진될 경우 19%의 이자율을 유지하기 어렵기 때문에 이는 최악의 경우 뱅크런 혹은 UST 수요 감소에 의한 연쇄 청산을 유발할 수도 있었다(특히 앵커가 테라 블록체인을 먹여살린다고 표현할 정도로 최대의 수요처였기 때문). 이런 우려와 함께 여러 논란 및 반박들이 있었지만, 결과적으로는 Luna Foundation Guard가 출범하면서 5000억원 상당의 준비금을 충당하였기 때문에 당분간은 이자율을 유지할 수 있을 것으로 보인다.\n최근 1달간의 앵커 Yield Reserve 기록은 https://mirrortracker.info/anchor 에서 확인할 수 있다.\nAnchor Token (ANC) 앵커의 가버넌스 토큰으로, Anchor Rate나 대출 시 최대 LTV와 같은 값들을 조정한다거나 하는 투표를 할 때 의결권을 행사할 수 있다. Borrower에게 ANC를 찍어서 지급하며 주기적으로 소각도 하는 듯 하다.\n최근에 ANC의 토크노믹스를 Curve의 veCRV와 같이 락업기간만큼 투표권을 추가시켜주는 식으로 바꾸자는 프로포절이 올라왔다. 이 때문에 커브처럼 ‘Anchor Wars’가 발생할 거라고 기대해서 ANC 가격이 많이 펌핑된 것으로 보인다.\n정리 앵커는 본딩된 PoS 토큰들을 담보로 받고 UST를 빌려줌으로서 채굴 수익 및 이자를 UST 예치자들에게 분배하는 고이율 디파이 은행이라고 볼 수 있다. 앵커의 장점은 다음으로 요약할 수 있다.\n스테이블코인으로 거의 안정적인 19~20%의 APY 테라의 목숨줄이므로 망할 수가 없음 이거 하나가 앵커를 다 먹여살리는 게 아닐까 싶다. 앵커의 리스크는 다음과 같다(필자가 캐치하지 못한 리스크가 더 있을 수 있음).\n상술한대로 장세에 따라 이율 변동이 있을 수 있다. Yield Reserve가 댐처럼 완충역할을 해주지만 근본적인 해결법은 아님 예치할 스테이블코인인 UST가 검증이 덜 된 알고리즘 스테이블코인이다 보니 아직 페깅이 완벽하다고 단언할 수 없다. 특히 앵커와 Abracadabra를 사용해 앵커 수익률을 레버리징하는 Degenbox 전략에 수백억이 예치되어있다 보니 (확률은 희박하지만) 연쇄 청산이 발생하면 페깅이 일시적으로 깨질 수 있음 (DeFi라면 항상 있는) 해킹 리스크 총평 전설의 시작\n앵커는 DeFi 플랫폼에서 전례없는 20% APY 를 제시하면서 매력적인, 그리고 테라를 먹여살리는 디파이 플랫폼이 되었다. 지금은 하락장 속에서 앵커가 Yield Reserve를 까먹으면서 LFG의 지원으로 버티고 있지만, 나는 이것이 테라폼 랩스의 일방적인 돈 기부가 아니라 UST를 ‘네오 달러’로 만들기 위한 공격적인 투자라 생각한다. 즉 앞으로도 앵커는 20% 언저리의 높은 이율을 유지하면서 사용자들을 끌어모을 것이라고 생각한다.\n물론 테라에 묶인 자금의 80% 이상이 앵커(와 Lido)에 들어간 지금의 모습은 테라 생태계에서도 장기적으로 좋은 모습은 아니다. 지금도 Mars, Prism 같은 디파이 프로토콜들이 열심히 개발 및 런칭중이니 점점 앵커에 대한 의존도는 줄어들 것이다. 암튼 앵커 짱.\n참고자료 https://docs.anchorprotocol.com/protocol https://docs.terra.money/docs/learn/protocol.html 각주 대신 검산은 아주 간단해야 한다. ↩︎\n채굴자에게 암호화폐를 위임하는 것은 실제로 소유권이 이전되지는 않기 때문이다. ↩︎\n항상 정확히 1:1은 아니다. bLUNA 운용비 혹은 위임한 채굴자가 처벌받았을 경우 자산 손실을 보전하기 위한 비용이 추가될 수 있다. ↩︎\n참고: 실제로 테라 블록체인에는 SDR(IMF 특별인출권)과 연동된 SDT, KRW와 연동되는 KRT 등이 있으나 편의상 UST만 가지고 서술한다. 테라의 명목상 주 스테이블코인은 SDT이다. ↩︎\n",
  "wordCount" : "1621",
  "inLanguage": "en",
  "datePublished": "2022-02-27T13:08:18+09:00",
  "dateModified": "2022-02-27T13:08:18+09:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://blog.cro.sh/posts/anchor-protocol-summary/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Option::None",
    "logo": {
      "@type": "ImageObject",
      "url": "http://blog.cro.sh/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://blog.cro.sh/" accesskey="h" title="Option::None (Alt + H)">Option::None</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Anchor Protocol Summary
    </h1>
    <div class="post-meta"><span title='2022-02-27 13:08:18 +0900 KST'>February 27, 2022</span>

</div>
  </header> 
  <div class="post-content"><h1 id="disclaimer">Disclaimer<a hidden class="anchor" aria-hidden="true" href="#disclaimer">#</a></h1>
<p>이 문서는 투자를 권유하는 내용이 아니며 정보 제공만을 목적으로 합니다. 부정확한 정보가 포함되었을 수 있습니다(발견
시 지적 부탁드립니다). 가상자산 및 가상자산 기반의 DApp에 투자하여 발생하는 모든 손실의 책임은 투자자 개인에게 있습니다.</p>
<h1 id="앵커-프로토콜">앵커 프로토콜<a hidden class="anchor" aria-hidden="true" href="#앵커-프로토콜">#</a></h1>
<p>앵커는 테라 블록체인의 은행 역할을 수행하는 프로토콜이다. 정확히는 화폐의 대차 업무를 담당하게 된다.
즉, 저축된 자산을 기반으로 대출자들에게 돈을 빌려주고 이자를 받아 배분하는 역할을 한다.</p>
<h1 id="bassets-bonded-assets">bAssets (Bonded Assets)<a hidden class="anchor" aria-hidden="true" href="#bassets-bonded-assets">#</a></h1>
<h2 id="posproof-of-stake">PoS(Proof-of-Stake)<a hidden class="anchor" aria-hidden="true" href="#posproof-of-stake">#</a></h2>
<p>Bonded assets에 대해 알기 전에 먼저 PoS(Proof-of-Stake, 지분증명) 블록체인에 대한 이해가 필요하다.</p>
<p>비트코인, 이더리움과 같은 초기의 블록체인은 PoW(Proof-of-Work, 작업증명) 방식으로 블록체인의
신뢰성을 유지하는데, 이는 성능이 좋은 CPU나 GPU, 혹은 전용 채굴 칩을 사용하여 내가 &lsquo;아주 어려운 문제<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>&lsquo;를
풀어낸 답을 제시하여 자신이 암호화폐를 채굴해냈음을 증명한다(다른 말로, 새로 발행한 다음 자신이 소유함을 증명한다).</p>
<p>지분증명 블록체인은 이 대신, 채굴자들이 이전까지 발행되었던 암호화폐를 소유하고 있음만을 증명하며 이에 따라 암호화폐를
발행하게 된다(PoW에 비해 문제의 난이도는 매우 낮음). PoS 블록체인에서는 채굴을 위해서 암호화폐를 소유하면서 블록체인에서
다른 채굴자와 통신할 서버를 운영해야 하는데, 암호화폐를 소유한 개개인이 이런 서버를 구동하기에는 번거롭기 때문에
대부분 서버를 운영하는 사람에게 자신이 소유한 암호화폐를 <em>위임</em>하여 채굴을 의뢰하게 된다.</p>
<p>PoS 방식으로 운용되는 블록체인으로는 테라(앵커 프로토콜이 구동되는 체인), 솔라나, 이더리움 비콘 체인(이더리움 2.0) 등이 있다.</p>
<h3 id="risk-of-delegation">Risk of Delegation<a hidden class="anchor" aria-hidden="true" href="#risk-of-delegation">#</a></h3>
<p>암호화폐를 채굴자에게 위임하는 것은 100% 수익을 보장하지는 않는다. 채굴자가 구동하는 서버가 오작동하여 블록체인 상에서
제대로 기능하지 못할 경우, 다른 채굴자들은 오작동한 채굴자에게 &lsquo;처벌(slashing)&lsquo;을 가할 수 있다. 이는 채굴자가 보유한 암호화폐가
일부 손실됨을 의미한다. 채굴자가 처벌받을 수 있는 경우는 다음을 포함한다.</p>
<ul>
<li>채굴자가 구동하는 채굴 프로그램의 오류</li>
<li>채굴자가 구동하는 서버에 대한 DDoS 등 외부에서의 공격</li>
<li>채굴자가 구동하는 서버가 정전됨</li>
</ul>
<p>채굴자가 위임받은 암호화폐를 횡령하거나 임의로 삭제시키는 것은 PoS 블록체인의 설계 상 불가능하다<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>.</p>
<h2 id="bonded-assets">Bonded Assets<a hidden class="anchor" aria-hidden="true" href="#bonded-assets">#</a></h2>
<p>앵커 프로토콜에서 가치를 창출하는 방법 중 하나는 위의 PoS 블록체인에 암호화폐를 위임함으로서 채굴 수익을 얻는 것이다.
테라 블록체인의 암호화폐인 LUNA를 예로 들면, LUNA 보유자들은 bLUNA 토큰을 LUNA와 1:1로<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> 교환할 수 있다. 엄밀히 표현하면,
LUNA를 채굴자에게 위임함으로서 동일한 양의 bLUNA를 발행할 수 있다. 위임된 LUNA는 바로 가져갈 수 없으며 최소 21일간 <!-- raw HTML omitted -->잠금(lock-up)<!-- raw HTML omitted -->하여 채굴에 사용된다. 잠금 기간이 끝난 후에는 bLUNA를 다시 반납하고 위임했던 LUNA를 돌려받고 채굴 수익도 청구할 수 있다. 채굴 수익은
테라 블록체인의 스테이블코인인 UST로 지급된다.</p>
<p>LUNA 외에도 이더리움과 <a href="https://lido.fi">Lido Finance</a>가 제공하는 이더리움 예치 서비스를 이용해 bETH를 발행할 수도 있다.</p>
<h1 id="stablecoins">Stablecoins<a hidden class="anchor" aria-hidden="true" href="#stablecoins">#</a></h1>
<p>스테이블코인에 대해 간략히 설명하겠다. 블록체인 위에서 달러를 직접 다루기에는 기술적/법적 문제가 있기 때문에, 달러 혹은
다른 기존 화폐와 가치가 연동되는(pegged) 암호화폐를 달러 대신 사용한다(주로 달러에 페깅된 스테이블코인만을 취급하는 곳이 많다). 시가총액이 높고 유명한 스테이블코인들을 간단히 설명하겠다.</p>
<h2 id="usdttether">USDT(Tether)<a hidden class="anchor" aria-hidden="true" href="#usdttether">#</a></h2>
<p>Tether 사에서 발행하는 스테이블코인으로, 달러를 예치하면 동일한 양의 USDT를 발행해준다.
발행사인 Tether가 조세회피처인 케이만 제도에 있다거나, 예치된 달러가 부실 채권 구매에 사용되었을 수 있다거나(특히 헝다그룹), 예치량보다 더 많은 USDT를 발행했다는 논란이 있어 신뢰성 문제가 있지만 아직까지는 스테이블코인 중 가장 시가총액이 높다.</p>
<h2 id="usdcusd-coin">USDC(USD Coin)<a hidden class="anchor" aria-hidden="true" href="#usdcusd-coin">#</a></h2>
<p>기본적인 원리는 Tether와 동일하지만 Centre Consortium이라는 기존 금융시장에서 신뢰할 만한 회사들이 모인 공동체가 주체가 되어
발행한다. USDT보다 신뢰성 문제가 적기 때문에 최근 시가총액이 크게 증가하고 있으며 근미래에 USDT를 추월할 수 있다고 평가받는다.</p>
<h2 id="dai">DAI<a hidden class="anchor" aria-hidden="true" href="#dai">#</a></h2>
<p>USDT, USDC는 발행 주체가 &lsquo;중앙화&rsquo;되어있기 때문에 발행 주체를 전적으로 신뢰해야 한다는 문제가 있다. 예를 들어, USDT와 USDC 모두
특정 계정(주로 해킹으로 USDT, USDC를 탈취한 계정)의 USDT/USDC 자금 이동을 정지시키는 일을 할 수 있는데, 이는 탈중앙화를 기본 이념으로 하는 암호화폐 생태계와 맞지 않기 때문에 탈중앙화된, 블록체인의 스마트 컨트랙트로만 컨트롤되는 암호화폐의 필요성이 대두되었다.</p>
<p>DAI는 암호화폐를 담보로 하여 발행받는 스테이블코인이다. 블록체인 위에서 구동되는 DApp에 암호화폐를 예치하면 DAI를 &lsquo;대출&rsquo;해주며,
블록체인의 특성상 무신용 대출이기 때문에 100% 미만의 LTV로만 대출받을 수 있다(이를 overcollaterized loan이라고도 한다).
담보로 맡긴 암호화폐의 가치가 하락하면 경매를 통해 맡긴 담보가 강제로 청산된다.</p>
<h2 id="ustterrausd">UST(TerraUSD)<a hidden class="anchor" aria-hidden="true" href="#ustterrausd">#</a></h2>
<p>DAI는 블록체인 상에서 발행과 청산이 모두 이루어지며 이 모든 것이 조작 불가능한, 그리고 민주적인 방식으로 이루어지기 때문에
스테이블코인의 탈중앙화를 이루었다고 평가받는다. 하지만 DAI는 발행이 항상 overcollaterized loan으로만 이루어지기
때문에 <strong>담보로 맡길 수 있는 암호화폐의 시가총액보다 DAI를 더 많이 발행할 수 없다</strong>는 문제가 발생한다(따지고 보면 USDT/USDC도 달러의
발행량보다 더 많이 발행될 수 없다는 문제가 있지만 암호화폐 담보와 비교할 바는 아니다).
테라는 이를 해결하기 위해 등장한 프로젝트로, 담보자산 없이 달러와 가치가 연동되는 스테이블코인을 만드는 것을 목표로 한다. 테라의 주된 암호화폐는 LUNA와 UST가 있다.
이를 통해 어떻게 UST가 USD와 가치가 연동되는지 알아보자<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>.</p>
<ul>
<li>항상 1 UST는 1달러 가치의 LUNA와 교환할 수 있다. 이는 테라 블록체인이 항상 보장한다.</li>
<li>아래의 예시에서 1 LUNA = 100 USD로 가정한다.
<ul>
<li>1 UST가 시장에서 1.01 USD의 가치를 지닌다면(UST의 유통량이 너무 적음):
<ul>
<li>시장에서 100 USD로 1 LUNA를 구입한다.</li>
<li>1 LUNA를 소각하고 100 UST를 발행한다.</li>
<li>100 UST를 101 USD로 팔아 1 USD의 차익을 얻는다.</li>
<li>시장에는 추가적인 UST가 풀림으로서 수요에 맞춰 공급량이 늘어난다.</li>
</ul>
</li>
<li>1 UST가 시장에서 0.99 USD의 가치를 지닌다면(UST의 유통량이 너무 많음):
<ul>
<li>시장에서 100 UST를 99 USD에 산다.</li>
<li>100 UST를 소각하고 1 LUNA를 발행한다.</li>
<li>1 LUNA를 100 USD로 팔아 1 USD의 차익을 얻는다.</li>
<li>UST의 유통량이 감소함으로서 줄어든 수요에 맞춰 공급량이 감소한다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>UST의 가격 유지는 이러한 차익거래만으로 이루어지며, 이렇게 담보 없이 알고리즘만으로 유지되는 스테이블코인을
<em>algorithmic stablecoin</em>이라 부른다. UST는 알고리즘 스테이블코인 중 가장 시가총액이 높다.</p>
<p>UST의 장점은 다음과 같다.</p>
<ul>
<li>탈중앙화: UST를 소유함으로서 특정 주체를 무한정 신뢰해야 할 필요가 없다.</li>
<li>확장성: 직접적으로 달러나 암호화폐를 담보로 삼지 않기 때문에, 발행량에 제한이 없다.</li>
</ul>
<p>UST의 위험성은 다음과 같다.</p>
<ul>
<li>검증되지 않음: 테라 프로젝트는 시작된 지 3년이 채 되지 않았다. 차익거래 알고리즘만으로 UST의
가격이 달러와 연동된다고 단언하기에는 불충분하다.</li>
<li>급격한 가격변동에 취약함: 비트코인 폭락 등으로 LUNA의 가격이 같이 폭락하면 차익거래 수요가 증가하지만
LUNA/UST를 소각 및 변환하는 양은 하루 단위로 제한되어 있다. 이로 인해 비트코인 폭락 시 깨진 페깅이 며칠에 걸쳐 복구된 적이 있었다.
<ul>
<li>최근 Binance와 같은 거래소에 UST/USDT 마켓 등이 추가되면서 이는 다소 개선될 것으로 보인다.</li>
<li>또한, LUNA의 시가총액이 크게 감소하면 공포에 빠진 사람들이 UST로 LUNA를 발행해 매도할 수 있으며
이는 LUNA 가격의 급락을 가속화시키는 악순환을 만들 수 있다(death spiral).</li>
<li>이 문제는 테라 팀에서도 인지하고 있는 듯 하며, 최근에 LFG(Luna Foundation Guard)가 출범하면서
1조원어치의 비트코인을 추가 담보로 삼아 LUNA와 동일하게 발행 및 소각할 수 있도록 하여
추가적인 신뢰성을 확보하였다.</li>
</ul>
</li>
<li>제도권과의 마찰: 테라를 개발한 Terraform Labs의 대표 권도형(Do Kwon)은 2021 말 SEC에게서 소환장을 받은
바 있고 이 마찰은 아직 진행중이다.
<ul>
<li>소환 사유는 SEC가 테라 블록체인의 DApp 중 하나인 Mirror Protocol이 미허가 증권을 발행한 것으로 해석했기 때문이다.
<ul>
<li>Mirror Protocol은 간단히 설명하면 Mirrored Assets를 발행하는 DApp으로 실제 증권(Amazon, Microsoft, Tesla 주식 등) 등의 가격을 추종하는 토큰이다(TSLA 가격을 추종하는 mTSLA, BTC 가격을 추종하는 mBTC 등).</li>
</ul>
</li>
<li>이는 2020년 SEC가 Ripple 코인을 발행하는 Ripple사를 증권법 위반으로 고발한 것과도 유사하다. 이 분쟁은 2년 넘게 계속 이어지고 있다.</li>
<li>권도형은 자신이 한국인이며 Terraform Labs는 한국/싱가포르 법인이기 때문에 이는 초법적 조치라며 항변하였고 SEC와 민사 소송을 진행하고 있다.</li>
</ul>
</li>
</ul>
<p>2022년 2월 기준, 아직까지는 1 UST = 1 USD로 가치가 잘 연동되고 있으며 간혹 페깅이 깨지는 경우도 있었지만
대부분 3~4일 내로 복구되는 모습을 보이고 있다.</p>
<h1 id="money-market">Money Market<a hidden class="anchor" aria-hidden="true" href="#money-market">#</a></h1>
<p>앵커 프로토콜의 대출 기능이다. 사용자는 UST를 대출 풀에 예치하고 이자 수익을 얻거나, 위에서 설명한
bonded asset을 담보로 맡기고 UST를 대출할 수 있다. 이 역시 무신용 대출이기 때문에 최대 LTV는 80%로 overcollaterize 되어 있으며, 담보 가치가 하락하면 청산이 일어날 수 있다. 그럼에도 불구하고 대출 수요가 존재하는 이유는 다음과 같다.</p>
<ul>
<li>대출받은 UST로 다른 암호화폐를 구입하면 담보로 맡긴 암호화폐와 함께 가격 변동에 노출되므로 레버리지 효과를 얻을 수 있다.</li>
<li>대출자에게도 ANC라는 자체 토큰을 발행해 지급하는데, 대출 이자보다 ANC 토큰으로 얻는 가치가 높기 때문에(총합 연이율 단리 3.8% 수준/2022년 2월 27일 기준) 담보물의 가치 변동을 무시하면 대출만 해도 이득이다.</li>
</ul>
<p>앵커 프로토콜은 Anchor Rate라는 목표 이자율을 설정한 뒤(이는 후에 설명할 ANC 토큰을 통한 투표로 이루어진다),
목표 이자율을 초과 달성하면 Yield Reserve라는 준비기금에 초과액을 저장하고 미달성하면 저장한 Yield Reserve에서 돈을 충당하여 UST를 제공한 사람들에게 이자를 지급한다. 현재 앵커의 이자율은 1년 복리 19.3% 수준을 유지하고 있다.</p>
<h2 id="최근-앵커에-대한-우려">최근 앵커에 대한 우려<a hidden class="anchor" aria-hidden="true" href="#최근-앵커에-대한-우려">#</a></h2>
<p>앵커의 수익 원천은 결국 대출자들이 지급하는 이자 및 예치한 Bonded Asset에서 나오는 채굴 수익이다.
시장이 전체적으로 상승장일 때는 이러한 수익이 많이 나오기 때문에 UST 제공자들에게 이자를 지급하기 용이하지만,
최근과 같이 전체적으로 하락 중일때는 목표 이자율을 달성하기 어렵고 이로 인해 Yield Reserve에 저장된 금액을
지속적으로 소모하게 된다. 앵커의 Yield Reserve는 2월 초에 700만 달러까지 감소하였으며 모두 소진될 경우
19%의 이자율을 유지하기 어렵기 때문에 이는 최악의 경우 뱅크런 혹은 UST 수요 감소에 의한 연쇄 청산을 유발할 수도
있었다(특히 앵커가 테라 블록체인을 먹여살린다고 표현할 정도로 최대의 수요처였기 때문). 이런 우려와 함께 여러
논란 및 반박들이 있었지만, 결과적으로는 Luna Foundation Guard가 출범하면서 5000억원 상당의 준비금을 충당하였기
때문에 당분간은 이자율을 유지할 수 있을 것으로 보인다.</p>
<p>최근 1달간의 앵커 Yield Reserve 기록은 <a href="https://mirrortracker.info/anchor">https://mirrortracker.info/anchor</a> 에서 확인할 수 있다.</p>
<h1 id="anchor-token-anc">Anchor Token (ANC)<a hidden class="anchor" aria-hidden="true" href="#anchor-token-anc">#</a></h1>
<p>앵커의 가버넌스 토큰으로, Anchor Rate나 대출 시 최대 LTV와 같은 값들을 조정한다거나 하는 투표를 할 때
의결권을 행사할 수 있다. Borrower에게 ANC를 찍어서 지급하며 주기적으로 소각도 하는 듯 하다.</p>
<p>최근에 ANC의 토크노믹스를 Curve의 veCRV와 같이 락업기간만큼 투표권을 추가시켜주는 식으로 바꾸자는 <a href="https://forum.anchorprotocol.com/t/proposal-veanc-evolving-anchor-tokenomics/2773">프로포절</a>이
올라왔다. 이 때문에 커브처럼 &lsquo;Anchor Wars&rsquo;가 발생할 거라고 기대해서 ANC 가격이 많이 펌핑된 것으로 보인다.</p>
<h1 id="정리">정리<a hidden class="anchor" aria-hidden="true" href="#정리">#</a></h1>
<p>앵커는 본딩된 PoS 토큰들을 담보로 받고 UST를 빌려줌으로서 채굴 수익 및 이자를 UST 예치자들에게 분배하는
고이율 디파이 은행이라고 볼 수 있다. 앵커의 장점은 다음으로 요약할 수 있다.</p>
<ul>
<li>스테이블코인으로 <em>거의</em> 안정적인 19~20%의 APY</li>
<li><del>테라의 목숨줄이므로 망할 수가 없음</del></li>
</ul>
<p>이거 하나가 앵커를 다 먹여살리는 게 아닐까 싶다.
앵커의 리스크는 다음과 같다(필자가 캐치하지 못한 리스크가 더 있을 수 있음).</p>
<ul>
<li>상술한대로 장세에 따라 이율 변동이 있을 수 있다.
<ul>
<li>Yield Reserve가 댐처럼 완충역할을 해주지만 근본적인 해결법은 아님</li>
</ul>
</li>
<li>예치할 스테이블코인인 UST가 검증이 덜 된 알고리즘 스테이블코인이다 보니 아직 페깅이 완벽하다고 단언할 수 없다.
<ul>
<li>특히 앵커와 Abracadabra를 사용해 앵커 수익률을 레버리징하는 Degenbox 전략에 수백억이 예치되어있다 보니
(확률은 희박하지만) 연쇄 청산이 발생하면 페깅이 일시적으로 깨질 수 있음</li>
</ul>
</li>
<li>(DeFi라면 항상 있는) 해킹 리스크</li>
</ul>
<h1 id="총평">총평<a hidden class="anchor" aria-hidden="true" href="#총평">#</a></h1>
<figure><a href="https://twitter.com/stablekwon/status/1371007624855052289?s=20&amp;t=D4XO3EMq6_wnFUKmajXrNw">
    <img loading="lazy" src="/img/do-kwon-introduces-anchor.png"
         alt="Do Kwon Introduces Anchor"/> </a><figcaption>
            <p>전설의 시작</p>
        </figcaption>
</figure>

<p>앵커는 DeFi 플랫폼에서 전례없는 <em>20% APY</em> 를 제시하면서 매력적인, 그리고 테라를 먹여살리는 디파이 플랫폼이 되었다.
지금은 하락장 속에서 앵커가 Yield Reserve를 까먹으면서 LFG의 지원으로 버티고 있지만, 나는 이것이 테라폼 랩스의 일방적인
돈 기부가 아니라 UST를 &lsquo;네오 달러&rsquo;로 만들기 위한 공격적인 투자라 생각한다. 즉 앞으로도 앵커는 20% 언저리의 높은 이율을
유지하면서 사용자들을 끌어모을 것이라고 생각한다.</p>
<p>물론 테라에 묶인 자금의 80% 이상이 앵커(와 Lido)에 들어간 지금의 모습은 테라 생태계에서도 장기적으로 좋은 모습은 아니다.
지금도 Mars, Prism 같은 디파이 프로토콜들이 열심히 개발 및 런칭중이니 점점 앵커에 대한 의존도는 줄어들 것이다. 암튼 앵커 짱.</p>
<h1 id="참고자료">참고자료<a hidden class="anchor" aria-hidden="true" href="#참고자료">#</a></h1>
<ul>
<li><a href="https://docs.anchorprotocol.com/protocol">https://docs.anchorprotocol.com/protocol</a></li>
<li><a href="https://docs.terra.money/docs/learn/protocol.html">https://docs.terra.money/docs/learn/protocol.html</a></li>
</ul>
<h1 id="각주">각주<a hidden class="anchor" aria-hidden="true" href="#각주">#</a></h1>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>대신 검산은 아주 간단해야 한다.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>채굴자에게 암호화폐를 위임하는 것은 실제로 소유권이 이전되지는 않기 때문이다.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>항상 정확히 1:1은 아니다. bLUNA 운용비 혹은 위임한 채굴자가 처벌받았을 경우 자산 손실을 보전하기 위한 비용이 추가될 수 있다.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>참고: 실제로 테라 블록체인에는 SDR(IMF 특별인출권)과 연동된 SDT, KRW와 연동되는 KRT 등이 있으나 편의상 UST만 가지고 서술한다.
테라의 명목상 주 스테이블코인은 SDT이다.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>© 2019-2021 Nam Junghyun</span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>
<script defer src='https://static.cloudflareinsights.com/beacon.min.js'
    data-cf-beacon='{"token": "152863abaa9948f9bb84e53ef4204e47"}'></script>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
